# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –Ω–∞ Railway

## üìã –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:**
- Connection string –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL: `caboose.proxy.rlwy.net:55140`
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `ConnectionStrings__DefaultConnection` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- Postgres —Å–µ—Ä–≤–∏—Å "Online"
- API —Å–µ—Ä–≤–∏—Å "Online"

‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
- `canConnect: false` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

### 1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway

Railway Dashboard ‚Üí API —Å–µ—Ä–≤–∏—Å ‚Üí Deploy Logs

–ò—â–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:
- `Npgsql Error - Code: ...` - –∫–æ–¥ –æ—à–∏–±–∫–∏ PostgreSQL
- `Detail: ...` - –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏
- `Hint: ...` - –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### 2. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

#### –ü—Ä–∏—á–∏–Ω–∞ 1: SSL/TLS –ø—Ä–æ–±–ª–µ–º–∞
Railway –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å SSL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å –≤ connection string –ø–∞—Ä–∞–º–µ—Ç—Ä `sslmode=require`:
```
postgresql://postgres:password@host:port/db?sslmode=require
```

#### –ü—Ä–∏—á–∏–Ω–∞ 2: –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä–æ–ª–µ–º
–ü–∞—Ä–æ–ª—å –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π `${{Postgres.DATABASE_PUBLIC_URL}}` - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç.

#### –ü—Ä–∏—á–∏–Ω–∞ 3: –ü–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
–ü–æ—Ä—Ç 55140 –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Postgres —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø.

---

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

### –®–∞–≥ 1: –ó–∞–ø—É—à–∏ —É–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–¥

```powershell
git add .
git commit -m "Improve database connection error diagnostics"
git push origin main
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

Railway Dashboard ‚Üí API —Å–µ—Ä–≤–∏—Å ‚Üí Deploy Logs

–ò—â–∏:
- `Npgsql Error - Code: ...` - —ç—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É
- `Detail: ...` - –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏
- `Hint: ...` - –ø–æ–¥—Å–∫–∞–∑–∫–∞

### –®–∞–≥ 3: –ü–æ–ø—Ä–æ–±—É–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Railway

–í–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ connection string –∏—Å–ø–æ–ª—å–∑—É–π:
```
${{Postgres.DATABASE_PUBLIC_URL}}
```

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–¥—Å—Ç–∞–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π connection string
- –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
- –û–±–Ω–æ–≤–∏—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ë–î

---

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ SSL, –¥–æ–±–∞–≤—å –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—Ä—É—á–Ω—É—é:

1. Railway Dashboard ‚Üí API —Å–µ—Ä–≤–∏—Å ‚Üí Variables
2. –ù–∞–π–¥–∏ `ConnectionStrings__DefaultConnection`
3. –î–æ–±–∞–≤—å –≤ –∫–æ–Ω–µ—Ü connection string: `?sslmode=require`

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç:
```
Host=caboose.proxy.rlwy.net;Port=55140;Database=railway;Username=postgres;Password=...;SslMode=Require;
```

---

## üìã –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

–ü—Ä–æ–≤–µ—Ä—å:
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É
- ‚úÖ `/health/db` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `canConnect: true`
- ‚úÖ `appliedMigrations` –Ω–µ –ø—É—Å—Ç–æ–π
- ‚úÖ `tablesExist: true`

---

**–ó–∞–ø—É—à–∏ –∫–æ–¥ –∏ –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ - —Ç–∞–º –±—É–¥–µ—Ç —Ç–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏!** üîç
